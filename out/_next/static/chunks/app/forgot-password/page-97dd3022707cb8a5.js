(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[781],{1488:function(e,t,r){Promise.resolve().then(r.bind(r,5406))},8030:function(e,t,r){"use strict";r.d(t,{Z:function(){return l}});var a=r(2265);/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),s=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&r.indexOf(e)===t).join(" ")};/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let o=(0,a.forwardRef)((e,t)=>{let{color:r="currentColor",size:n=24,strokeWidth:o=2,absoluteStrokeWidth:l,className:c="",children:u,iconNode:d,...m}=e;return(0,a.createElement)("svg",{ref:t,...i,width:n,height:n,stroke:r,strokeWidth:l?24*Number(o)/Number(n):o,className:s("lucide",c),...m},[...d.map(e=>{let[t,r]=e;return(0,a.createElement)(t,r)}),...Array.isArray(u)?u:[u]])}),l=(e,t)=>{let r=(0,a.forwardRef)((r,i)=>{let{className:l,...c}=r;return(0,a.createElement)(o,{ref:i,iconNode:t,className:s("lucide-".concat(n(e)),l),...c})});return r.displayName="".concat(e),r}},1976:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(8030).Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},6780:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(8030).Z)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},2940:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(8030).Z)("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},4086:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(8030).Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},7138:function(e,t,r){"use strict";r.d(t,{default:function(){return n.a}});var a=r(231),n=r.n(a)},5406:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return d}});var a=r(7437),n=r(2265),s=r(7138),i=r(9630),o=r(2940),l=r(1976),c=r(6780),u=r(4086);function d(){let[e,t]=(0,n.useState)(""),[r,d]=(0,n.useState)(!1),[m,f]=(0,n.useState)(""),[h,x]=(0,n.useState)(!1),{resetPassword:y}=(0,i.a)(),g=async t=>{t.preventDefault(),f(""),d(!0);try{await y(e),x(!0)}catch(e){f(e.message)}finally{d(!1)}};return h?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-saudi-green to-green-700 py-12 px-4 sm:px-6 lg:px-8",children:(0,a.jsx)("div",{className:"max-w-md w-full",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-xl p-8 text-center",children:[(0,a.jsx)(o.Z,{className:"h-16 w-16 text-green-500 mx-auto mb-4"}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"تم إرسال الرسالة!"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:"تم إرسال رسالة إعادة تعيين كلمة المرور إلى بريدك الإلكتروني. يرجى التحقق من صندوق الوارد ومجلد الرسائل غير المرغوب فيها."}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)(s.default,{href:"/login",className:"w-full inline-flex justify-center items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-saudi-green hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-saudi-green",children:[(0,a.jsx)(l.Z,{className:"h-4 w-4 ml-2"}),"العودة إلى تسجيل الدخول"]}),(0,a.jsx)("button",{onClick:()=>{x(!1),t("")},className:"w-full inline-flex justify-center items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-saudi-green",children:"إرسال رسالة أخرى"})]})]})})}):(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-saudi-green to-green-700 py-12 px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-xl p-8",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"نسيت كلمة المرور؟"}),(0,a.jsx)("p",{className:"text-gray-600",children:"أدخل بريدك الإلكتروني وسنرسل لك رابط إعادة تعيين كلمة المرور"})]}),m&&(0,a.jsx)("div",{className:"mt-4 bg-red-50 border border-red-200 rounded-md p-4",children:(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)(c.Z,{className:"h-5 w-5 text-red-400"}),(0,a.jsx)("div",{className:"mr-3",children:(0,a.jsx)("p",{className:"text-sm text-red-800",children:m})})]})}),(0,a.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:g,children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"email",className:"form-label",children:"البريد الإلكتروني"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:(0,a.jsx)(u.Z,{className:"h-5 w-5 text-gray-400"})}),(0,a.jsx)("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,className:"form-input pr-10",placeholder:"أدخل بريدك الإلكتروني",value:e,onChange:e=>t(e.target.value)})]})]}),(0,a.jsx)("div",{children:(0,a.jsx)("button",{type:"submit",disabled:r,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-saudi-green hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-saudi-green disabled:opacity-50 disabled:cursor-not-allowed",children:r?(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white ml-2"}),"جاري الإرسال..."]}):"إرسال رابط إعادة التعيين"})}),(0,a.jsx)("div",{className:"text-center space-y-2",children:(0,a.jsx)(s.default,{href:"/login",className:"text-sm font-medium text-saudi-green hover:text-green-700",children:"تذكرت كلمة المرور؟ تسجيل الدخول"})})]})]}),(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)(s.default,{href:"/",className:"text-white hover:text-gray-200 text-sm font-medium",children:"← العودة إلى الصفحة الرئيسية"})})]})})}},9630:function(e,t,r){"use strict";r.d(t,{AuthProvider:function(){return u},a:function(){return c}});var a=r(7437),n=r(2265),s=r(5735),i=r(9506),o=r(3494);let l=(0,n.createContext)(void 0),c=()=>{let e=(0,n.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e},u=e=>{let{children:t}=e,[r,c]=(0,n.useState)(null),[u,m]=(0,n.useState)(null),[f,h]=(0,n.useState)(!0),x=async(e,t)=>{try{let r=await (0,s.e5)(i.I8,e,t);r.user&&await (0,o.V4)(r.user.uid)}catch(e){throw console.error("Login error:",e),Error(d(e.code))}},y=async(e,t,r)=>{try{let a=await (0,s.Xb)(i.I8,e,t);a.user&&(await (0,s.ck)(a.user,{displayName:r.displayName}),await (0,o.r4)({uid:a.user.uid,email:a.user.email,displayName:r.displayName,role:r.role||"student",university:r.university,graduationYear:r.graduationYear}),await (0,s.w$)(a.user))}catch(e){throw console.error("Registration error:",e),Error(d(e.code))}},g=async()=>{try{await (0,s.w7)(i.I8),c(null),m(null)}catch(e){throw console.error("Logout error:",e),Error("فشل في تسجيل الخروج")}},w=async e=>{try{await (0,s.LS)(i.I8,e)}catch(e){throw console.error("Password reset error:",e),Error(d(e.code))}},p=async e=>{if(!u)throw Error("لا يوجد مستخدم مسجل دخول");try{await (0,s.ck)(u,{displayName:e}),r&&await (0,o.r4)({...r,displayName:e})}catch(e){throw console.error("Profile update error:",e),Error("فشل في تحديث الملف الشخصي")}},v=async()=>{if(!u)throw Error("لا يوجد مستخدم مسجل دخول");try{await (0,s.w$)(u)}catch(e){throw console.error("Email verification error:",e),Error("فشل في إرسال رسالة التحقق")}};return(0,n.useEffect)(()=>(0,s.Aj)(i.I8,async e=>{if(m(e),e)try{let t=await (0,o.PR)(e.uid);c(t)}catch(e){console.error("Error fetching user data:",e),c(null)}else c(null);h(!1)}),[]),(0,a.jsx)(l.Provider,{value:{currentUser:r,firebaseUser:u,loading:f,login:x,register:y,logout:g,resetPassword:w,updateUserProfile:p,sendVerificationEmail:v},children:t})},d=e=>{switch(e){case"auth/user-not-found":return"لا يوجد حساب مرتبط بهذا البريد الإلكتروني";case"auth/wrong-password":return"كلمة المرور غير صحيحة";case"auth/email-already-in-use":return"هذا البريد الإلكتروني مستخدم بالفعل";case"auth/weak-password":return"كلمة المرور ضعيفة. يجب أن تكون 6 أحرف على الأقل";case"auth/invalid-email":return"البريد الإلكتروني غير صحيح";case"auth/user-disabled":return"تم تعطيل هذا الحساب";case"auth/too-many-requests":return"تم تجاوز عدد المحاولات المسموح. حاول مرة أخرى لاحقاً";case"auth/network-request-failed":return"خطأ في الاتصال بالإنترنت";default:return"حدث خطأ غير متوقع. حاول مرة أخرى"}}},9506:function(e,t,r){"use strict";r.d(t,{I8:function(){return u},db:function(){return d},tO:function(){return m}});var a=r(5236),n=r(5735),s=r(9842),i=r(9854),o=r(7175);let l={apiKey:"AIzaSyBVPwdXDXdGJzH4bdEJTmGO6CLdwJcFvp0",authDomain:"sple-exam-system.firebaseapp.com",projectId:"sple-exam-system",storageBucket:"sple-exam-system.firebasestorage.app",messagingSenderId:"684476565122",appId:"1:684476565122:web:65f005113e5e29e421569b",measurementId:"G-JM2SWJY950"};if(!l.apiKey||!l.authDomain||!l.projectId)throw Error("Firebase configuration is incomplete. Please check your environment variables.");let c=(0,a.ZF)(l),u=(0,n.v0)(c),d=(0,s.ad)(c),m=(0,i.cF)(c);(0,o.IH)(c)},3494:function(e,t,r){"use strict";r.d(t,{$V:function(){return g},Ds:function(){return h},Km:function(){return x},L$:function(){return p},PR:function(){return u},V4:function(){return d},f_:function(){return w},iv:function(){return f},nW:function(){return y},r4:function(){return c},tI:function(){return m}});var a=r(9842),n=r(9506);let s=(0,a.hJ)(n.db,"users"),i=(0,a.hJ)(n.db,"questions"),o=(0,a.hJ)(n.db,"examSessions"),l=(0,a.hJ)(n.db,"userProgress"),c=async e=>{let t=(0,a.JU)(s,e.uid);await (0,a.r7)(t,{...e,createdAt:(0,a.Bt)(),lastLogin:(0,a.Bt)()})},u=async e=>{let t=(0,a.JU)(s,e),r=await (0,a.QT)(t);if(r.exists()){var n,i;let e=r.data();return{uid:r.id,...e,createdAt:(null===(n=e.createdAt)||void 0===n?void 0:n.toDate())||new Date,lastLogin:(null===(i=e.lastLogin)||void 0===i?void 0:i.toDate())||new Date}}return null},d=async e=>{let t=(0,a.JU)(s,e);await (0,a.r7)(t,{lastLogin:(0,a.Bt)()})},m=async function(e,t){let r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:50,s=[(0,a.ar)("approved","==",r),(0,a.Xo)("createdAt","desc"),(0,a.b9)(n)];e&&s.splice(1,0,(0,a.ar)("domain","==",e)),t&&s.splice(e?2:1,0,(0,a.ar)("difficulty","==",t));let o=(0,a.IO)(i,...s);return(await (0,a.PL)(o)).docs.map(e=>{var t;return{id:e.id,...e.data(),createdAt:(null===(t=e.data().createdAt)||void 0===t?void 0:t.toDate())||new Date}})},f=async(e,t,r)=>{let a=(await m(t,r,!0,3*e)).sort(()=>.5-Math.random());return a.slice(0,Math.min(e,a.length))},h=async(e,t)=>{let r=(0,a.JU)(i,e);await (0,a.r7)(r,t)},x=async e=>{let t=(0,a.JU)(i,e);await (0,a.oe)(t)},y=async e=>(await (0,a.ET)(o,{...e,startTime:e.startTime||(0,a.Bt)(),endTime:e.endTime||null})).id,g=async function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20,n=[(0,a.ar)("userId","==",e),(0,a.Xo)("startTime","desc"),(0,a.b9)(r)];t&&n.splice(1,0,(0,a.ar)("examType","==",t));let s=(0,a.IO)(o,...n);return(await (0,a.PL)(s)).docs.map(e=>{var t,r;return{id:e.id,...e.data(),startTime:(null===(t=e.data().startTime)||void 0===t?void 0:t.toDate())||new Date,endTime:(null===(r=e.data().endTime)||void 0===r?void 0:r.toDate())||void 0}})},w=async(e,t)=>{let r=(0,a.JU)(o,e),n={...t};t.endTime&&(n.endTime=a.EK.fromDate(t.endTime)),await (0,a.r7)(r,n)},p=async e=>{let t=(0,a.JU)(l,e),r=await (0,a.QT)(t);if(r.exists()){var n;let t=r.data();return{userId:e,...t,lastUpdated:(null===(n=t.lastUpdated)||void 0===n?void 0:n.toDate())||new Date}}return null}}},function(e){e.O(0,[358,139,230,231,971,23,744],function(){return e(e.s=1488)}),_N_E=e.O()}]);