"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[685],{8030:function(e,r,t){t.d(r,{Z:function(){return u}});var a=t(2265);/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),i=function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return r.filter((e,r,t)=>!!e&&t.indexOf(e)===r).join(" ")};/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a.forwardRef)((e,r)=>{let{color:t="currentColor",size:n=24,strokeWidth:s=2,absoluteStrokeWidth:u,className:c="",children:l,iconNode:d,...f}=e;return(0,a.createElement)("svg",{ref:r,...o,width:n,height:n,stroke:t,strokeWidth:u?24*Number(s)/Number(n):s,className:i("lucide",c),...f},[...d.map(e=>{let[r,t]=e;return(0,a.createElement)(r,t)}),...Array.isArray(l)?l:[l]])}),u=(e,r)=>{let t=(0,a.forwardRef)((t,o)=>{let{className:u,...c}=t;return(0,a.createElement)(s,{ref:o,iconNode:r,className:i("lucide-".concat(n(e)),u),...c})});return t.displayName="".concat(e),t}},6463:function(e,r,t){var a=t(1169);t.o(a,"useRouter")&&t.d(r,{useRouter:function(){return a.useRouter}})},7034:function(e,r,t){t.d(r,{Z:function(){return u}});var a=t(7437),n=t(2265),i=t(6463),o=t(9630);function s(e){let{size:r="md",color:t="primary",text:n,fullScreen:i=!1}=e,o=(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full border-2 border-t-transparent ".concat({sm:"h-4 w-4",md:"h-8 w-8",lg:"h-12 w-12"}[r]," ").concat({primary:"border-saudi-green",white:"border-white",gray:"border-gray-600"}[t])}),n&&(0,a.jsx)("p",{className:"mt-2 text-sm ".concat("white"===t?"text-white":"text-gray-600"),children:n})]});return i?(0,a.jsx)("div",{className:"fixed inset-0 bg-white bg-opacity-75 flex items-center justify-center z-50",children:o}):o}function u(e){let{children:r,requireAdmin:t=!1,redirectTo:u="/login"}=e,{currentUser:c,loading:l}=(0,o.a)(),d=(0,i.useRouter)();return((0,n.useEffect)(()=>{if(!l){if(!c){d.push(u);return}if(t&&"admin"!==c.role){d.push("/dashboard");return}}},[c,l,d,t,u]),l)?(0,a.jsx)(s,{}):!c||t&&"admin"!==c.role?null:(0,a.jsx)(a.Fragment,{children:r})}},9630:function(e,r,t){t.d(r,{AuthProvider:function(){return l},a:function(){return c}});var a=t(7437),n=t(2265),i=t(5735),o=t(9506),s=t(3494);let u=(0,n.createContext)(void 0),c=()=>{let e=(0,n.useContext)(u);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e},l=e=>{let{children:r}=e,[t,c]=(0,n.useState)(null),[l,f]=(0,n.useState)(null),[m,h]=(0,n.useState)(!0),w=async(e,r)=>{try{let t=await (0,i.e5)(o.I8,e,r);t.user&&await (0,s.V4)(t.user.uid)}catch(e){throw console.error("Login error:",e),Error(d(e.code))}},y=async(e,r,t)=>{try{let a=await (0,i.Xb)(o.I8,e,r);a.user&&(await (0,i.ck)(a.user,{displayName:t.displayName}),await (0,s.r4)({uid:a.user.uid,email:a.user.email,displayName:t.displayName,role:t.role||"student",university:t.university,graduationYear:t.graduationYear}),await (0,i.w$)(a.user))}catch(e){throw console.error("Registration error:",e),Error(d(e.code))}},v=async()=>{try{await (0,i.w7)(o.I8),c(null),f(null)}catch(e){throw console.error("Logout error:",e),Error("فشل في تسجيل الخروج")}},p=async e=>{try{await (0,i.LS)(o.I8,e)}catch(e){throw console.error("Password reset error:",e),Error(d(e.code))}},g=async e=>{if(!l)throw Error("لا يوجد مستخدم مسجل دخول");try{await (0,i.ck)(l,{displayName:e}),t&&await (0,s.r4)({...t,displayName:e})}catch(e){throw console.error("Profile update error:",e),Error("فشل في تحديث الملف الشخصي")}},b=async()=>{if(!l)throw Error("لا يوجد مستخدم مسجل دخول");try{await (0,i.w$)(l)}catch(e){throw console.error("Email verification error:",e),Error("فشل في إرسال رسالة التحقق")}};return(0,n.useEffect)(()=>(0,i.Aj)(o.I8,async e=>{if(f(e),e)try{let r=await (0,s.PR)(e.uid);c(r)}catch(e){console.error("Error fetching user data:",e),c(null)}else c(null);h(!1)}),[]),(0,a.jsx)(u.Provider,{value:{currentUser:t,firebaseUser:l,loading:m,login:w,register:y,logout:v,resetPassword:p,updateUserProfile:g,sendVerificationEmail:b},children:r})},d=e=>{switch(e){case"auth/user-not-found":return"لا يوجد حساب مرتبط بهذا البريد الإلكتروني";case"auth/wrong-password":return"كلمة المرور غير صحيحة";case"auth/email-already-in-use":return"هذا البريد الإلكتروني مستخدم بالفعل";case"auth/weak-password":return"كلمة المرور ضعيفة. يجب أن تكون 6 أحرف على الأقل";case"auth/invalid-email":return"البريد الإلكتروني غير صحيح";case"auth/user-disabled":return"تم تعطيل هذا الحساب";case"auth/too-many-requests":return"تم تجاوز عدد المحاولات المسموح. حاول مرة أخرى لاحقاً";case"auth/network-request-failed":return"خطأ في الاتصال بالإنترنت";default:return"حدث خطأ غير متوقع. حاول مرة أخرى"}}},9506:function(e,r,t){t.d(r,{I8:function(){return l},db:function(){return d},tO:function(){return f}});var a=t(5236),n=t(5735),i=t(9842),o=t(9854),s=t(7175);let u={apiKey:"AIzaSyBVPwdXDXdGJzH4bdEJTmGO6CLdwJcFvp0",authDomain:"sple-exam-system.firebaseapp.com",projectId:"sple-exam-system",storageBucket:"sple-exam-system.firebasestorage.app",messagingSenderId:"684476565122",appId:"1:684476565122:web:65f005113e5e29e421569b",measurementId:"G-JM2SWJY950"};if(!u.apiKey||!u.authDomain||!u.projectId)throw Error("Firebase configuration is incomplete. Please check your environment variables.");let c=(0,a.ZF)(u),l=(0,n.v0)(c),d=(0,i.ad)(c),f=(0,o.cF)(c);(0,s.IH)(c)},3494:function(e,r,t){t.d(r,{$V:function(){return v},Ds:function(){return h},Km:function(){return w},L$:function(){return g},PR:function(){return l},V4:function(){return d},f_:function(){return p},iv:function(){return m},nW:function(){return y},r4:function(){return c},tI:function(){return f}});var a=t(9842),n=t(9506);let i=(0,a.hJ)(n.db,"users"),o=(0,a.hJ)(n.db,"questions"),s=(0,a.hJ)(n.db,"examSessions"),u=(0,a.hJ)(n.db,"userProgress"),c=async e=>{let r=(0,a.JU)(i,e.uid);await (0,a.r7)(r,{...e,createdAt:(0,a.Bt)(),lastLogin:(0,a.Bt)()})},l=async e=>{let r=(0,a.JU)(i,e),t=await (0,a.QT)(r);if(t.exists()){var n,o;let e=t.data();return{uid:t.id,...e,createdAt:(null===(n=e.createdAt)||void 0===n?void 0:n.toDate())||new Date,lastLogin:(null===(o=e.lastLogin)||void 0===o?void 0:o.toDate())||new Date}}return null},d=async e=>{let r=(0,a.JU)(i,e);await (0,a.r7)(r,{lastLogin:(0,a.Bt)()})},f=async function(e,r){let t=!(arguments.length>2)||void 0===arguments[2]||arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:50,i=[(0,a.ar)("approved","==",t),(0,a.Xo)("createdAt","desc"),(0,a.b9)(n)];e&&i.splice(1,0,(0,a.ar)("domain","==",e)),r&&i.splice(e?2:1,0,(0,a.ar)("difficulty","==",r));let s=(0,a.IO)(o,...i);return(await (0,a.PL)(s)).docs.map(e=>{var r;return{id:e.id,...e.data(),createdAt:(null===(r=e.data().createdAt)||void 0===r?void 0:r.toDate())||new Date}})},m=async(e,r,t)=>{let a=(await f(r,t,!0,3*e)).sort(()=>.5-Math.random());return a.slice(0,Math.min(e,a.length))},h=async(e,r)=>{let t=(0,a.JU)(o,e);await (0,a.r7)(t,r)},w=async e=>{let r=(0,a.JU)(o,e);await (0,a.oe)(r)},y=async e=>(await (0,a.ET)(s,{...e,startTime:e.startTime||(0,a.Bt)(),endTime:e.endTime||null})).id,v=async function(e,r){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20,n=[(0,a.ar)("userId","==",e),(0,a.Xo)("startTime","desc"),(0,a.b9)(t)];r&&n.splice(1,0,(0,a.ar)("examType","==",r));let i=(0,a.IO)(s,...n);return(await (0,a.PL)(i)).docs.map(e=>{var r,t;return{id:e.id,...e.data(),startTime:(null===(r=e.data().startTime)||void 0===r?void 0:r.toDate())||new Date,endTime:(null===(t=e.data().endTime)||void 0===t?void 0:t.toDate())||void 0}})},p=async(e,r)=>{let t=(0,a.JU)(s,e),n={...r};r.endTime&&(n.endTime=a.EK.fromDate(r.endTime)),await (0,a.r7)(t,n)},g=async e=>{let r=(0,a.JU)(u,e),t=await (0,a.QT)(r);if(t.exists()){var n;let r=t.data();return{userId:e,...r,lastUpdated:(null===(n=r.lastUpdated)||void 0===n?void 0:n.toDate())||new Date}}return null}}}]);